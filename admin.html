<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å - –ù–æ–≤–æ–≥–æ–¥–Ω–∞—è –ò–≥—Ä–∞ v5.3.5</title>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    
    <!-- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è -->
    <script src="firebase-config.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 3px solid #667eea;
        }

        .header h1 {
            color: #667eea;
            font-size: 32px;
            margin-bottom: 10px;
        }

        .header .version {
            color: #666;
            font-size: 16px;
            background: #f0f0f0;
            padding: 5px 15px;
            border-radius: 15px;
            display: inline-block;
        }

        /* –≠–∫—Ä–∞–Ω –¥–æ—Å—Ç—É–ø–∞ */
        .access-screen {
            display: block;
            text-align: center;
            padding: 100px 0;
        }

        .access-screen:not(.active) {
            display: none;
        }

        .access-container {
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            max-width: 400px;
            margin: 0 auto;
        }

        .access-container h2 {
            color: #333;
            margin-bottom: 20px;
            font-size: 24px;
        }

        .access-container input {
            width: 100%;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            margin-bottom: 15px;
        }

        .access-container input:focus {
            outline: none;
            border-color: #667eea;
        }

        .access-container button {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .access-container button:hover {
            transform: translateY(-2px);
        }

        /* –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç */
        .admin-content {
            display: none;
        }

        .admin-content:not(.hidden) {
            display: block;
        }

        /* –í–∫–ª–∞–¥–∫–∏ */
        .tabs {
            display: flex;
            margin-bottom: 30px;
            background: white;
            border-radius: 10px;
            padding: 5px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .tab {
            flex: 1;
            padding: 15px;
            text-align: center;
            background: transparent;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
            font-weight: 500;
        }

        .tab.active {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .tab:hover:not(.active) {
            background: #f5f5f5;
        }

        /* –ö–æ–Ω—Ç–µ–Ω—Ç –≤–∫–ª–∞–¥–æ–∫ */
        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* –ö–∞—Ä—Ç–æ—á–∫–∏ */
        .card {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .card h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .card p {
            color: #666;
            margin-bottom: 20px;
            line-height: 1.6;
        }

        /* –ö–Ω–æ–ø–∫–∏ */
        .btn-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }

        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .btn-success {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
        }

        .btn-warning {
            background: linear-gradient(135deg, #ff9800, #f57c00);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(135deg, #f44336, #d32f2f);
            color: white;
        }

        .btn-info {
            background: linear-gradient(135deg, #2196F3, #1976D2);
            color: white;
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        /* –§–æ—Ä–º—ã */
        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 500;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        /* –¢–∞–±–ª–∏—Ü—ã */
        .table-container {
            overflow-x: auto;
            margin-top: 20px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 8px;
            overflow: hidden;
        }

        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        th {
            background: #f8f9fa;
            font-weight: 600;
            color: #333;
        }

        tr:hover {
            background: #f8f9fa;
        }

        /* –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .stat-card .number {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
        }

        .stat-card .label {
            color: #666;
            margin-top: 5px;
        }

        /* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            transform: translateX(100%);
            transition: transform 0.3s;
            z-index: 1000;
            max-width: 300px;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success {
            background: linear-gradient(135deg, #4CAF50, #45a049);
        }

        .notification.error {
            background: linear-gradient(135deg, #f44336, #d32f2f);
        }

        .notification.info {
            background: linear-gradient(135deg, #2196F3, #1976D2);
        }

        /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-content h3 {
            margin-bottom: 20px;
            color: #333;
        }

        .modal-content .btn-group {
            margin-top: 20px;
            justify-content: flex-end;
        }

        /* –°–ø–∏—Å–∫–∏ –∑–∞–¥–∞—á */
        .task-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            border-left: 4px solid #667eea;
        }

        .task-item h4 {
            color: #333;
            margin-bottom: 5px;
        }

        .task-item p {
            color: #666;
            font-size: 14px;
            margin: 0;
        }

        .task-actions {
            margin-top: 10px;
            display: flex;
            gap: 10px;
        }

        /* QR –∫–æ–¥ */
        #qrModal {
            text-align: center;
        }

        #qrModal img {
            max-width: 300px;
            border-radius: 8px;
        }

        /* –û—à–∏–±–∫–∏ */
        #accessError {
            color: #f44336;
            margin-top: 10px;
            display: none;
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }

            .tabs {
                flex-direction: column;
            }

            .tab {
                text-align: left;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .btn-group {
                flex-direction: column;
            }

            .btn {
                justify-content: center;
            }
        }

        /* –ó–∞–≥—Ä—É–∑–∫–∞ */
        .loading {
            text-align: center;
            padding: 20px;
            color: #666;
        }

        .loading::after {
            content: '';
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #667eea;
            border-radius: 50%;
            border-top-color: transparent;
            animation: spin 1s linear infinite;
            margin-left: 10px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è */
        .fade-in {
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéÑ –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –ù–æ–≤–æ–≥–æ–¥–Ω–µ–π –ò–≥—Ä—ã</h1>
            <div class="version">v5.3.5 –§–ò–ù–ê–õ–¨–ù–ê–Ø –í–ï–†–°–ò–Ø</div>
        </div>

        <!-- –≠–∫—Ä–∞–Ω –¥–æ—Å—Ç—É–ø–∞ -->
        <div class="access-screen active" id="accessScreen">
            <div class="access-container">
                <h2>–í—Ö–æ–¥ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</h2>
                <div class="form-group">
                    <input type="password" id="accessCode" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –¥–æ—Å—Ç—É–ø–∞">
                </div>
                <button onclick="checkAccess()">üîë –í–æ–π—Ç–∏</button>
                <div id="accessError"></div>
            </div>
        </div>

        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
        <div class="admin-content hidden" id="adminContent">
            <!-- –í–∫–ª–∞–¥–∫–∏ -->
            <div class="tabs">
                <button class="tab active" onclick="switchTab('quick-actions')">‚ö° –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</button>
                <button class="tab" onclick="switchTab('game-management')">üéÆ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–π</button>
                <button class="tab" onclick="switchTab('results')">üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã</button>
                <button class="tab" onclick="switchTab('settings')">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
            </div>

            <!-- –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è -->
            <div class="tab-content active" id="quick-actions">
                <div class="card">
                    <h3>üöÄ –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h3>
                    <p>–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–≥—Ä–æ–π</p>
                    
                    <div class="btn-group">
                        <button class="btn btn-primary" onclick="generateGameLink()">
                            üìã –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ –∏–≥—Ä—É
                        </button>
                        
                        <button class="btn btn-success" onclick="downloadQRCode()">
                            üì± –°–∫–∞—á–∞—Ç—å QR-–∫–æ–¥
                        </button>
                        
                        <button class="btn btn-warning" onclick="printInstructions()">
                            üñ®Ô∏è –ü–µ—á–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π
                        </button>
                        
                        <button class="btn btn-primary" onclick="openGame()">
                            üéØ –û—Ç–∫—Ä—ã—Ç—å –∏–≥—Ä—É
                        </button>
                        
                        <button class="btn btn-info" onclick="showQRModal()">
                            üëÅÔ∏è –ü–æ–∫–∞–∑–∞—Ç—å QR-–∫–æ–¥
                        </button>
                    </div>
                </div>

                <div class="card">
                    <h3>üîç –°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã</h3>
                    <div id="systemStatus">
                        <button class="btn btn-primary" onclick="checkSystem()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∏—Å—Ç–µ–º—É</button>
                        <div id="systemInfo" style="margin-top: 15px;"></div>
                    </div>
                </div>
            </div>

            <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–π -->
            <div class="tab-content" id="game-management">
                <div class="card">
                    <h3>üìù –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è–º–∏</h3>
                    <div class="btn-group">
                        <button class="btn btn-success" onclick="addNewTask()">‚ûï –î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ</button>
                        <button class="btn btn-warning" onclick="editTask()">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                        <button class="btn btn-danger" onclick="deleteTask()">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</button>
                        <button class="btn btn-primary" onclick="loadTasks()">üîÑ –ó–∞–≥—Ä—É–∑–∏—Ç—å –∑–∞–¥–∞–Ω–∏—è</button>
                    </div>
                    <div class="task-list" id="taskList" style="margin-top: 20px;">
                        <p>–ù–∞–∂–º–∏—Ç–µ "–ó–∞–≥—Ä—É–∑–∏—Ç—å –∑–∞–¥–∞–Ω–∏—è" –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å–ø–∏—Å–∫–∞</p>
                    </div>
                </div>

                <div class="card">
                    <h3>üíæ GitHub –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label>GitHub –í–ª–∞–¥–µ–ª–µ—Ü:</label>
                            <input type="text" id="githubOwner" value="fancifulaction-rgb">
                        </div>
                        <div class="form-group">
                            <label>–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:</label>
                            <input type="text" id="githubRepo" value="christmas_game">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Personal Access Token:</label>
                        <input type="password" id="githubToken" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–æ–∫–µ–Ω">
                    </div>
                    <div class="btn-group">
                        <button class="btn btn-success" onclick="setupGitHubIntegration()">üíæ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é</button>
                        <button class="btn btn-primary" onclick="testGitHubConnection()">üîó –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ</button>
                        <button class="btn btn-warning" onclick="autoSaveToGitHub()">üîÑ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞ GitHub</button>
                    </div>
                </div>
            </div>

            <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã -->
            <div class="tab-content" id="results">
                <div class="card">
                    <h3>üèÜ –õ–∏–¥–µ—Ä–±–æ—Ä–¥</h3>
                    <div class="btn-group">
                        <button class="btn btn-primary" onclick="loadResults()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</button>
                        <button class="btn btn-success" onclick="exportResults()">üìä –≠–∫—Å–ø–æ—Ä—Ç –≤ CSV</button>
                        <button class="btn btn-danger" onclick="clearResults()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</button>
                    </div>
                    
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>‚Ññ</th>
                                    <th>–ò–≥—Ä–æ–∫</th>
                                    <th>–û—á–∫–∏</th>
                                    <th>–ó–∞–¥–∞–Ω–∏—è</th>
                                    <th>–í—Ä–µ–º—è</th>
                                    <th>–ü–æ–¥—Å–∫–∞–∑–∫–∏</th>
                                    <th>–õ–µ–≥–∫–∏–µ</th>
                                    <th>–°—Ä–µ–¥–Ω–∏–µ</th>
                                    <th>–°–ª–æ–∂–Ω—ã–µ</th>
                                    <th>–î–∞—Ç–∞</th>
                                </tr>
                            </thead>
                            <tbody id="resultsBody">
                                <tr>
                                    <td colspan="10" style="text-align: center; padding: 20px;">
                                        üìä –ù–∞–∂–º–∏—Ç–µ "–û–±–Ω–æ–≤–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã" –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="card">
                    <h3>üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="number" id="totalGames">0</div>
                            <div class="label">–í—Å–µ–≥–æ –∏–≥—Ä</div>
                        </div>
                        <div class="stat-card">
                            <div class="number" id="averageScore">0</div>
                            <div class="label">–°—Ä–µ–¥–Ω–∏–π —Å—á–µ—Ç</div>
                        </div>
                        <div class="stat-card">
                            <div class="number" id="totalHints">0</div>
                            <div class="label">–í—Å–µ–≥–æ –ø–æ–¥—Å–∫–∞–∑–æ–∫</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ -->
            <div class="tab-content" id="settings">
                <div class="card">
                    <h3>üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</h3>
                    <div class="form-group">
                        <label>–¢–µ–∫—É—â–∏–π –ø–∞—Ä–æ–ª—å:</label>
                        <input type="password" id="currentPassword">
                    </div>
                    <div class="form-group">
                        <label>–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å:</label>
                        <input type="password" id="newPassword">
                    </div>
                    <div class="form-group">
                        <label>–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –ø–∞—Ä–æ–ª—å:</label>
                        <input type="password" id="confirmPassword">
                    </div>
                    <button class="btn btn-primary" onclick="changePassword()">
                        üîí –ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å
                    </button>
                </div>

                <div class="card">
                    <h3>üéÆ –ò–≥—Ä–æ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</h3>
                    <div class="form-group">
                        <label>–ù–∞–∑–≤–∞–Ω–∏–µ –∏–≥—Ä—ã:</label>
                        <input type="text" id="gameTitle" value="–ù–æ–≤–æ–≥–æ–¥–Ω—è—è –û—Ö–æ—Ç–∞ –∑–∞ –°–æ–∫—Ä–æ–≤–∏—â–∞–º–∏">
                    </div>
                    <div class="form-group">
                        <label>–û–ø–∏—Å–∞–Ω–∏–µ –∏–≥—Ä—ã:</label>
                        <textarea id="gameDescription" rows="3">–†–æ–∂–¥–µ—Å—Ç–≤–µ–Ω—Å–∫–∞—è –∏–≥—Ä–∞-–ø–æ–∏—Å–∫ —Å –∑–∞–¥–∞–Ω–∏—è–º–∏ –¥–ª—è –≤—Å–µ–π —Å–µ–º—å–∏!</textarea>
                    </div>
                    <button class="btn btn-success" onclick="saveGameSettings()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</button>
                </div>
            </div>
        </div>
    </div>

    <!-- QR Modal -->
    <div class="modal" id="qrModal" style="display: none;">
        <div class="modal-content">
            <h3>üì± QR-–∫–æ–¥ –∏–≥—Ä—ã</h3>
            <img id="qrCodeImage" src="" alt="QR-–∫–æ–¥">
            <div class="btn-group" style="margin-top: 20px; justify-content: center;">
                <button class="btn btn-primary" onclick="downloadQRCode()">üíæ –°–∫–∞—á–∞—Ç—å</button>
                <button class="btn btn-secondary" onclick="document.getElementById('qrModal').style.display = 'none'">‚ùå –ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
    </div>

    <script>
        // –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã
        const GAME_ACCESS_CODE = 'ChristmasGame2025!';
        const GAME_URL = 'https://fancifulaction-rgb.github.io/christmas_game/index.html';
        
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let firebaseApp = null;
        let firebaseDB = null;
        let gameTasks = [];
        let adminAccess = false;

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            checkExistingAccess();
        });

        // –§–£–ù–ö–¶–ò–ò –î–û–°–¢–£–ü–ê
        function checkAccess() {
            const code = document.getElementById('accessCode').value;
            const currentPassword = localStorage.getItem('admin_password') || GAME_ACCESS_CODE;
            
            if (code === currentPassword) {
                localStorage.setItem('admin_access', 'true');
                document.getElementById('accessScreen').classList.remove('active');
                document.getElementById('adminContent').classList.remove('hidden');
                adminAccess = true;
                initFirebase();
                loadResults();
                showNotification('‚úÖ –î–æ—Å—Ç—É–ø —Ä–∞–∑—Ä–µ—à–µ–Ω!', 'success');
            } else {
                document.getElementById('accessError').textContent = '‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –∫–æ–¥ –¥–æ—Å—Ç—É–ø–∞!';
                document.getElementById('accessError').style.display = 'block';
                showNotification('‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –∫–æ–¥ –¥–æ—Å—Ç—É–ø–∞!', 'error');
            }
        }

        function checkExistingAccess() {
            if (localStorage.getItem('admin_access') === 'true') {
                document.getElementById('accessScreen').classList.remove('active');
                document.getElementById('adminContent').classList.remove('hidden');
                adminAccess = true;
                initFirebase();
                loadResults();
            }
        }

        // –°–ú–ï–ù–ê –ü–ê–†–û–õ–Ø
        function changePassword() {
            const currentPassword = document.getElementById('currentPassword').value;
            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            const storedPassword = localStorage.getItem('admin_password') || GAME_ACCESS_CODE;

            if (currentPassword !== storedPassword) {
                showNotification('‚ùå –¢–µ–∫—É—â–∏–π –ø–∞—Ä–æ–ª—å –Ω–µ–≤–µ—Ä–Ω—ã–π!', 'error');
                return;
            }

            if (newPassword.length < 4) {
                showNotification('‚ùå –ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 4 —Å–∏–º–≤–æ–ª–∞!', 'error');
                return;
            }

            if (newPassword !== confirmPassword) {
                showNotification('‚ùå –ù–æ–≤—ã–µ –ø–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç!', 'error');
                return;
            }

            localStorage.setItem('admin_password', newPassword);
            showNotification('‚úÖ –ü–∞—Ä–æ–ª—å —É—Å–ø–µ—à–Ω–æ –∏–∑–º–µ–Ω–µ–Ω!', 'success');
            
            // –û—á–∏—Å—Ç–∫–∞ –ø–æ–ª–µ–π
            document.getElementById('currentPassword').value = '';
            document.getElementById('newPassword').value = '';
            document.getElementById('confirmPassword').value = '';
        }

        // –£–ü–†–ê–í–õ–ï–ù–ò–ï –¢–ê–ë–ê–ú–ò
        function switchTab(tabName) {
            // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å–æ –≤—Å–µ—Ö —Ç–∞–±–æ–≤
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å –∫ –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É —Ç–∞–±—É
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
            if (tabName === 'results') {
                loadResults();
            }
        }

        // FIREBASE –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø
        function initFirebase() {
            try {
                if (typeof window.FIREBASE_CONFIG !== 'undefined') {
                    firebase.initializeApp(window.FIREBASE_CONFIG);
                    firebaseApp = firebase;
                    firebaseDB = firebase.database();
                    console.log('Firebase –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω —É—Å–ø–µ—à–Ω–æ');
                    showNotification('‚úÖ Firebase –ø–æ–¥–∫–ª—é—á–µ–Ω!', 'success');
                } else {
                    console.error('–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Firebase –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
                    showNotification('‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Firebase', 'error');
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Firebase:', error);
                showNotification('‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Firebase', 'error');
            }
        }

        // –ò–ì–†–û–í–´–ï –§–£–ù–ö–¶–ò–ò
        function generateGameLink() {
            const gameUrl = GAME_URL + '?access=' + 
                (localStorage.getItem('admin_password') || GAME_ACCESS_CODE);
            
            navigator.clipboard.writeText(gameUrl)
                .then(() => {
                    showNotification('‚úÖ –°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!', 'success');
                })
                .catch(() => {
                    // Fallback –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤
                    const textArea = document.createElement('textarea');
                    textArea.value = gameUrl;
                    document.body.appendChild(textArea);
                    textArea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textArea);
                    showNotification('‚úÖ –°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞!', 'success');
                });
        }

        function downloadQRCode() {
            const gameUrl = GAME_URL + '?access=' + 
                (localStorage.getItem('admin_password') || GAME_ACCESS_CODE);
            const qrUrl = `https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=${encodeURIComponent(gameUrl)}`;
            
            const link = document.createElement('a');
            link.href = qrUrl;
            link.download = 'christmas-game-qr.png';
            link.click();
            showNotification('üì± QR-–∫–æ–¥ –∑–∞–≥—Ä—É–∂–µ–Ω!', 'success');
        }

        function printInstructions() {
            const gameUrl = GAME_URL + '?access=' + 
                (localStorage.getItem('admin_password') || GAME_ACCESS_CODE);
            
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <html>
                <head>
                    <title>–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è –ù–æ–≤–æ–≥–æ–¥–Ω–µ–π –ò–≥—Ä—ã</title>
                    <style>
                        body { font-family: Arial, sans-serif; padding: 20px; }
                        h1 { color: #667eea; }
                        .qr-code { text-align: center; margin: 20px 0; }
                        .instructions { margin: 20px 0; }
                        .url { background: #f0f0f0; padding: 10px; border-radius: 5px; font-family: monospace; }
                    </style>
                </head>
                <body>
                    <h1>üéÑ –ù–æ–≤–æ–≥–æ–¥–Ω—è—è –û—Ö–æ—Ç–∞ –∑–∞ –°–æ–∫—Ä–æ–≤–∏—â–∞–º–∏</h1>
                    <div class="qr-code">
                        <img src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(gameUrl)}" alt="QR-–∫–æ–¥ –∏–≥—Ä—ã">
                    </div>
                    <div class="instructions">
                        <h2>–ö–∞–∫ –∏–≥—Ä–∞—Ç—å:</h2>
                        <ol>
                            <li>–û—Ç—Å–∫–∞–Ω–∏—Ä—É–π—Ç–µ QR-–∫–æ–¥ –∏–ª–∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –ø–æ —Å—Å—ã–ª–∫–µ</li>
                            <li>–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã</li>
                            <li>–†–µ—à–∞–π—Ç–µ –∑–∞–¥–∞–Ω–∏—è –ø–æ –ø–æ—Ä—è–¥–∫—É</li>
                            <li>–°–æ–±–∏—Ä–∞–π—Ç–µ –æ—á–∫–∏ –∏ —Å—Ç–∞–Ω—å—Ç–µ —á–µ–º–ø–∏–æ–Ω–æ–º!</li>
                        </ol>
                        <h3>–°—Å—ã–ª–∫–∞ –Ω–∞ –∏–≥—Ä—É:</h3>
                        <div class="url">${gameUrl}</div>
                    </div>
                </body>
                </html>
            `);
            printWindow.document.close();
            printWindow.print();
        }

        function openGame() {
            const gameUrl = GAME_URL + '?access=' + 
                (localStorage.getItem('admin_password') || GAME_ACCESS_CODE);
            window.open(gameUrl, '_blank');
        }

        function showQRModal() {
            const gameUrl = GAME_URL + '?access=' + 
                (localStorage.getItem('admin_password') || GAME_ACCESS_CODE);
            const qrUrl = `https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=${encodeURIComponent(gameUrl)}`;
            
            document.getElementById('qrCodeImage').src = qrUrl;
            document.getElementById('qrModal').style.display = 'flex';
        }

        // –°–ò–°–¢–ï–ú–ù–´–ï –§–£–ù–ö–¶–ò–ò
        function checkSystem() {
            const systemInfo = document.getElementById('systemInfo');
            
            let info = '<div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">';
            info += '<h4>üîç –°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã:</h4>';
            info += '<ul style="list-style: none; padding: 0;">';
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ Firebase
            if (firebaseDB) {
                info += '<li style="color: green;">‚úÖ Firebase –ø–æ–¥–∫–ª—é—á–µ–Ω</li>';
            } else {
                info += '<li style="color: red;">‚ùå Firebase –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω</li>';
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ GitHub
            const githubConfig = JSON.parse(localStorage.getItem('github_config') || '{}');
            if (githubConfig.token) {
                info += '<li style="color: green;">‚úÖ GitHub –Ω–∞—Å—Ç—Ä–æ–µ–Ω</li>';
            } else {
                info += '<li style="color: orange;">‚ö†Ô∏è GitHub –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω</li>';
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–¥–∞–Ω–∏–π
            info += `<li style="color: ${gameTasks.length > 0 ? 'green' : 'orange'};">üìù –ó–∞–¥–∞–Ω–∏–π: ${gameTasks.length}</li>`;
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–æ–ª—è
            const storedPassword = localStorage.getItem('admin_password');
            if (storedPassword && storedPassword !== GAME_ACCESS_CODE) {
                info += '<li style="color: green;">üîë –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –ø–∞—Ä–æ–ª—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω</li>';
            } else {
                info += '<li style="color: orange;">‚ö†Ô∏è –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–∞—Ä–æ–ª—å</li>';
            }
            
            info += '</ul></div>';
            systemInfo.innerHTML = info;
            
            showNotification('üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º—ã –∑–∞–≤–µ—Ä—à–µ–Ω–∞', 'info');
        }

        // –£–ü–†–ê–í–õ–ï–ù–ò–ï –ó–ê–î–ê–ù–ò–Ø–ú–ò
        function addNewTask() {
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.innerHTML = `
                <div class="modal-content">
                    <h3>‚ûï –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ</h3>
                    <form id="addTaskForm">
                        <div class="form-group">
                            <label>–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è:</label>
                            <input type="text" id="taskTitle" required>
                        </div>
                        <div class="form-group">
                            <label>–ö–æ–¥ –æ—Ç–≤–µ—Ç–∞:</label>
                            <input type="text" id="taskCode" required>
                        </div>
                        <div class="form-group">
                            <label>–°–ª–æ–∂–Ω–æ—Å—Ç—å:</label>
                            <select id="taskDifficulty">
                                <option value="easy">–õ–µ–≥–∫–æ–µ</option>
                                <option value="medium">–°—Ä–µ–¥–Ω–µ–µ</option>
                                <option value="hard">–°–ª–æ–∂–Ω–æ–µ</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>–û—á–∫–∏:</label>
                            <input type="number" id="taskPoints" value="10" min="1">
                        </div>
                        <div class="form-group">
                            <label>–ü–æ–¥—Å–∫–∞–∑–∫–∞:</label>
                            <textarea id="taskHint"></textarea>
                        </div>
                        <div class="btn-group">
                            <button type="submit" class="btn btn-success">–î–æ–±–∞–≤–∏—Ç—å</button>
                            <button type="button" class="btn btn-secondary" onclick="this.closest('.modal').remove()">–û—Ç–º–µ–Ω–∞</button>
                        </div>
                    </form>
                </div>
            `;
            document.body.appendChild(modal);
            
            document.getElementById('addTaskForm').onsubmit = function(e) {
                e.preventDefault();
                const newTask = {
                    id: Date.now(),
                    question: document.getElementById('taskTitle').value,
                    code: document.getElementById('taskCode').value,
                    difficulty: document.getElementById('taskDifficulty').value,
                    points: parseInt(document.getElementById('taskPoints').value),
                    hint: document.getElementById('taskHint').value
                };
                
                // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ Firebase
                if (firebaseDB) {
                    firebase.database().ref('tasks').push(newTask)
                        .then(() => {
                            showNotification('‚úÖ –ó–∞–¥–∞–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ!', 'success');
                            modal.remove();
                            loadTasks();
                        })
                        .catch(error => {
                            showNotification('‚ùå –û—à–∏–±–∫–∞: ' + error.message, 'error');
                        });
                } else {
                    showNotification('‚ùå Firebase –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω', 'error');
                }
            };
        }

        function editTask() {
            if (gameTasks.length === 0) {
                showNotification('‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞–≥—Ä—É–∑–∏—Ç–µ –∑–∞–¥–∞–Ω–∏—è', 'error');
                return;
            }
            
            const taskList = gameTasks.map((task, index) => 
                `${index + 1}. ${task.question} (${task.difficulty})`
            ).join('\n');
            
            const selected = prompt(`–í—ã–±–µ—Ä–∏—Ç–µ –Ω–æ–º–µ—Ä –∑–∞–¥–∞–Ω–∏—è –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:\n\n${taskList}`);
            const taskIndex = parseInt(selected) - 1;
            
            if (taskIndex >= 0 && taskIndex < gameTasks.length) {
                const task = gameTasks[taskIndex];
                const modal = document.createElement('div');
                modal.className = 'modal';
                modal.innerHTML = `
                    <div class="modal-content">
                        <h3>‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–¥–∞–Ω–∏–µ</h3>
                        <form id="editTaskForm">
                            <div class="form-group">
                                <label>–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è:</label>
                                <input type="text" id="taskTitle" value="${task.question}" required>
                            </div>
                            <div class="form-group">
                                <label>–ö–æ–¥ –æ—Ç–≤–µ—Ç–∞:</label>
                                <input type="text" id="taskCode" value="${task.code}" required>
                            </div>
                            <div class="form-group">
                                <label>–°–ª–æ–∂–Ω–æ—Å—Ç—å:</label>
                                <select id="taskDifficulty">
                                    <option value="easy" ${task.difficulty === 'easy' ? 'selected' : ''}>–õ–µ–≥–∫–æ–µ</option>
                                    <option value="medium" ${task.difficulty === 'medium' ? 'selected' : ''}>–°—Ä–µ–¥–Ω–µ–µ</option>
                                    <option value="hard" ${task.difficulty === 'hard' ? 'selected' : ''}>–°–ª–æ–∂–Ω–æ–µ</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>–û—á–∫–∏:</label>
                                <input type="number" id="taskPoints" value="${task.points}" min="1">
                            </div>
                            <div class="form-group">
                                <label>–ü–æ–¥—Å–∫–∞–∑–∫–∞:</label>
                                <textarea id="taskHint">${task.hint}</textarea>
                            </div>
                            <div class="btn-group">
                                <button type="submit" class="btn btn-success">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                                <button type="button" class="btn btn-secondary" onclick="this.closest('.modal').remove()">–û—Ç–º–µ–Ω–∞</button>
                            </div>
                        </form>
                    </div>
                `;
                document.body.appendChild(modal);
                
                document.getElementById('editTaskForm').onsubmit = function(e) {
                    e.preventDefault();
                    const updatedTask = {
                        question: document.getElementById('taskTitle').value,
                        code: document.getElementById('taskCode').value,
                        difficulty: document.getElementById('taskDifficulty').value,
                        points: parseInt(document.getElementById('taskPoints').value),
                        hint: document.getElementById('taskHint').value
                    };
                    
                    gameTasks[taskIndex] = { ...task, ...updatedTask };
                    
                    if (firebaseDB) {
                        firebase.database().ref('tasks').set(gameTasks)
                            .then(() => {
                                showNotification('‚úÖ –ó–∞–¥–∞–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–æ!', 'success');
                                modal.remove();
                                loadTasks();
                            })
                            .catch(error => {
                                showNotification('‚ùå –û—à–∏–±–∫–∞: ' + error.message, 'error');
                            });
                    } else {
                        showNotification('‚úÖ –ó–∞–¥–∞–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–æ –≤ –ø–∞–º—è—Ç–∏', 'success');
                        modal.remove();
                        loadTasks();
                    }
                };
            }
        }

        function deleteTask() {
            if (gameTasks.length === 0) {
                showNotification('‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞–≥—Ä—É–∑–∏—Ç–µ –∑–∞–¥–∞–Ω–∏—è', 'error');
                return;
            }
            
            const taskList = gameTasks.map((task, index) => 
                `${index + 1}. ${task.question}`
            ).join('\n');
            
            const selected = prompt(`–í—ã–±–µ—Ä–∏—Ç–µ –Ω–æ–º–µ—Ä –∑–∞–¥–∞–Ω–∏—è –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è:\n\n${taskList}`);
            const taskIndex = parseInt(selected) - 1;
            
            if (taskIndex >= 0 && taskIndex < gameTasks.length) {
                if (confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ –∑–∞–¥–∞–Ω–∏–µ?')) {
                    gameTasks.splice(taskIndex, 1);
                    
                    if (firebaseDB) {
                        firebase.database().ref('tasks').set(gameTasks)
                            .then(() => {
                                showNotification('‚úÖ –ó–∞–¥–∞–Ω–∏–µ —É–¥–∞–ª–µ–Ω–æ!', 'success');
                                loadTasks();
                            })
                            .catch(error => {
                                showNotification('‚ùå –û—à–∏–±–∫–∞: ' + error.message, 'error');
                            });
                    } else {
                        showNotification('‚úÖ –ó–∞–¥–∞–Ω–∏–µ —É–¥–∞–ª–µ–Ω–æ –∏–∑ –ø–∞–º—è—Ç–∏', 'success');
                        loadTasks();
                    }
                }
            }
        }

        function loadTasks() {
            const taskList = document.getElementById('taskList');
            taskList.innerHTML = '<div class="loading">–ó–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∑–∞–¥–∞–Ω–∏—è...</div>';
            
            // –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ Firebase
            if (firebaseDB) {
                firebase.database().ref('tasks').once('value')
                    .then(snapshot => {
                        const data = snapshot.val();
                        if (data) {
                            gameTasks = Object.values(data);
                        } else {
                            // –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
                            loadTasksFromFile();
                        }
                        renderTaskList();
                    })
                    .catch(error => {
                        console.log('–û—à–∏–±–∫–∞ Firebase, –∑–∞–≥—Ä—É–∂–∞–µ–º –∏–∑ —Ñ–∞–π–ª–∞:', error);
                        loadTasksFromFile();
                    });
            } else {
                loadTasksFromFile();
            }
        }

        function loadTasksFromFile() {
            fetch('game-data.json')
                .then(response => response.json())
                .then(data => {
                    gameTasks = data;
                    renderTaskList();
                })
                .catch(error => {
                    console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–¥–∞–Ω–∏–π:', error);
                    taskList.innerHTML = '<p>‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–¥–∞–Ω–∏–π</p>';
                });
        }

        function renderTaskList() {
            const taskList = document.getElementById('taskList');
            
            if (gameTasks.length === 0) {
                taskList.innerHTML = '<p>–ó–∞–¥–∞–Ω–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>';
                return;
            }
            
            let html = '<h4>üìù –°–ø–∏—Å–æ–∫ –∑–∞–¥–∞–Ω–∏–π:</h4>';
            gameTasks.forEach((task, index) => {
                html += `
                    <div class="task-item">
                        <h4>${index + 1}. ${task.question}</h4>
                        <p><strong>–ö–æ–¥:</strong> ${task.code} | <strong>–°–ª–æ–∂–Ω–æ—Å—Ç—å:</strong> ${task.difficulty} | <strong>–û—á–∫–∏:</strong> ${task.points}</p>
                        ${task.hint ? `<p><strong>–ü–æ–¥—Å–∫–∞–∑–∫–∞:</strong> ${task.hint}</p>` : ''}
                    </div>
                `;
            });
            
            taskList.innerHTML = html;
        }

        // –†–ï–ó–£–õ–¨–¢–ê–¢–´
        function loadResults() {
            if (!firebaseDB) {
                document.getElementById('resultsBody').innerHTML = 
                    '<tr><td colspan="10" style="text-align: center; padding: 20px;">‚ùå Firebase –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω</td></tr>';
                return;
            }
            
            document.getElementById('resultsBody').innerHTML = 
                '<tr><td colspan="10" style="text-align: center; padding: 20px;">–ó–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã...</td></tr>';
            
            firebase.database().ref('games').once('value')
                .then(snapshot => {
                    const games = snapshot.val();
                    if (!games) {
                        document.getElementById('resultsBody').innerHTML = 
                            '<tr><td colspan="10" style="text-align: center; padding: 20px;">–†–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</td></tr>';
                        return;
                    }
                    
                    const resultsArray = Object.entries(games).map(([key, game]) => ({
                        key,
                        playerName: game.playerName || game.teamName || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ',
                        totalScore: game.totalScore || 0,
                        completedTasks: game.completedTasks || 0,
                        gameTime: formatTime(game.gameDuration || 0),
                        hintsUsed: game.hintsUsed || 0,
                        easyTasks: game.difficultyStats?.easy || 0,
                        mediumTasks: game.difficultyStats?.medium || 0,
                        hardTasks: game.difficultyStats?.hard || 0,
                        endTime: new Date(game.endTime).toLocaleString('ru-RU')
                    }));
                    
                    resultsArray.sort((a, b) => b.totalScore - a.totalScore);
                    
                    const html = resultsArray.map((result, index) => `
                        <tr>
                            <td>${index + 1}</td>
                            <td>${result.playerName}</td>
                            <td>${result.totalScore}</td>
                            <td>${result.completedTasks}</td>
                            <td>${result.gameTime}</td>
                            <td>${result.hintsUsed}</td>
                            <td>${result.easyTasks}</td>
                            <td>${result.mediumTasks}</td>
                            <td>${result.hardTasks}</td>
                            <td>${result.endTime}</td>
                        </tr>
                    `).join('');
                    
                    document.getElementById('resultsBody').innerHTML = html;
                    
                    // –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                    updateStats(resultsArray);
                    
                    showNotification(`‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã: ${resultsArray.length}`, 'success');
                })
                .catch(error => {
                    document.getElementById('resultsBody').innerHTML = 
                        '<tr><td colspan="10" style="text-align: center; padding: 20px; color: red;">‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</td></tr>';
                    showNotification('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ' + error.message, 'error');
                });
        }

        function updateStats(resultsArray) {
            const totalGames = resultsArray.length;
            const totalScore = resultsArray.reduce((sum, result) => sum + result.totalScore, 0);
            const totalHints = resultsArray.reduce((sum, result) => sum + result.hintsUsed, 0);
            
            document.getElementById('totalGames').textContent = totalGames;
            document.getElementById('averageScore').textContent = totalGames > 0 ? Math.round(totalScore / totalGames) : 0;
            document.getElementById('totalHints').textContent = totalHints;
        }

        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${mins}:${secs.toString().padStart(2, '0')}`;
        }

        function exportResults() {
            if (!firebaseDB) {
                showNotification('‚ùå Firebase –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω', 'error');
                return;
            }
            
            firebase.database().ref('games').once('value')
                .then(snapshot => {
                    const games = snapshot.val();
                    if (!games) {
                        showNotification('‚ö†Ô∏è –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞', 'error');
                        return;
                    }
                    
                    const resultsArray = Object.entries(games).map(([key, game]) => ({
                        –ò–≥—Ä–æ–∫: game.playerName || game.teamName || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ',
                        '–û—á–∫–∏': game.totalScore || 0,
                        '–ó–∞–¥–∞–Ω–∏—è': game.completedTasks || 0,
                        '–í—Ä–µ–º—è': formatTime(game.gameDuration || 0),
                        '–ü–æ–¥—Å–∫–∞–∑–∫–∏': game.hintsUsed || 0,
                        '–õ–µ–≥–∫–∏–µ': game.difficultyStats?.easy || 0,
                        '–°—Ä–µ–¥–Ω–∏–µ': game.difficultyStats?.medium || 0,
                        '–°–ª–æ–∂–Ω—ã–µ': game.difficultyStats?.hard || 0,
                        '–î–∞—Ç–∞': new Date(game.endTime).toLocaleString('ru-RU')
                    }));
                    
                    const csv = convertToCSV(resultsArray);
                    const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
                    const link = document.createElement('a');
                    link.href = URL.createObjectURL(blob);
                    link.download = `christmas-game-results-${new Date().toISOString().split('T')[0]}.csv`;
                    link.click();
                    
                    showNotification('üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã!', 'success');
                })
                .catch(error => {
                    showNotification('‚ùå –û—à–∏–±–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞: ' + error.message, 'error');
                });
        }

        function convertToCSV(array) {
            if (array.length === 0) return '';
            
            const headers = Object.keys(array[0]);
            const csvContent = [
                headers.join(','),
                ...array.map(row => headers.map(header => `"${row[header]}"`).join(','))
            ].join('\n');
            
            return csvContent;
        }

        function clearResults() {
            if (!firebaseDB) {
                showNotification('‚ùå Firebase –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω', 'error');
                return;
            }
            
            if (confirm('–£–¥–∞–ª–∏—Ç—å –≤—Å–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å!')) {
                firebase.database().ref('games').remove()
                    .then(() => {
                        document.getElementById('resultsBody').innerHTML = 
                            '<tr><td colspan="10" style="text-align: center; padding: 20px;">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—á–∏—â–µ–Ω—ã</td></tr>';
                        showNotification('üóëÔ∏è –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—á–∏—â–µ–Ω—ã!', 'success');
                    })
                    .catch(error => {
                        showNotification('‚ùå –û—à–∏–±–∫–∞: ' + error.message, 'error');
                    });
            }
        }

        // GITHUB –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø
        function setupGitHubIntegration() {
            const owner = document.getElementById('githubOwner').value;
            const repo = document.getElementById('githubRepo').value;
            const token = document.getElementById('githubToken').value;
            
            if (!token) {
                showNotification('‚ùå –í–≤–µ–¥–∏—Ç–µ Personal Access Token', 'error');
                return;
            }
            
            const config = {
                owner: owner,
                repo: repo,
                token: token,
                setupTime: new Date().toISOString()
            };
            
            localStorage.setItem('github_config', JSON.stringify(config));
            showNotification('‚úÖ GitHub –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!', 'success');
        }

        function testGitHubConnection() {
            const githubConfig = JSON.parse(localStorage.getItem('github_config') || '{}');
            
            if (!githubConfig.token) {
                showNotification('‚ùå –°–Ω–∞—á–∞–ª–∞ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é', 'error');
                return;
            }
            
            const url = `https://api.github.com/repos/${githubConfig.owner}/${githubConfig.repo}`;
            
            fetch(url, {
                headers: {
                    'Authorization': `token ${githubConfig.token}`,
                    'Accept': 'application/vnd.github.v3+json'
                }
            })
            .then(response => {
                if (response.ok) {
                    showNotification('‚úÖ GitHub –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ!', 'success');
                } else {
                    throw new Error(`HTTP ${response.status}`);
                }
            })
            .catch(error => {
                showNotification('‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è: ' + error.message, 'error');
            });
        }

        function autoSaveToGitHub() {
            const githubConfig = JSON.parse(localStorage.getItem('github_config') || '{}');
            
            if (!githubConfig.token) {
                showNotification('‚ùå –ù–∞—Å—Ç—Ä–æ–π—Ç–µ GitHub –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å–Ω–∞—á–∞–ª–∞', 'error');
                return;
            }
            
            const config = {
                owner: githubConfig.owner,
                repo: githubConfig.repo,
                token: githubConfig.token
            };
            
            const gameData = {
                title: "–ù–æ–≤–æ–≥–æ–¥–Ω—è—è –û—Ö–æ—Ç–∞ –∑–∞ –°–æ–∫—Ä–æ–≤–∏—â–∞–º–∏",
                lastUpdated: new Date().toISOString(),
                tasks: gameTasks
            };
            
            const content = btoa(unescape(encodeURIComponent(JSON.stringify(gameData, null, 2))));
            const url = `https://api.github.com/repos/${config.owner}/${config.repo}/contents/game-data.json`;
            
            fetch(url, {
                method: 'PUT',
                headers: {
                    'Authorization': `token ${config.token}`,
                    'Accept': 'application/vnd.github.v3+json',
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    message: '–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏–π —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å',
                    content: content
                })
            })
            .then(response => {
                if (response.ok) {
                    showNotification('‚úÖ –ó–∞–¥–∞–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –Ω–∞ GitHub!', 'success');
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
            })
            .catch(error => {
                console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞ GitHub:', error);
                showNotification('‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è: ' + error.message, 'error');
            });
        }

        // –ù–ê–°–¢–†–û–ô–ö–ò –ò–ì–†–´
        function saveGameSettings() {
            const gameTitle = document.getElementById('gameTitle').value;
            const gameDescription = document.getElementById('gameDescription').value;
            
            const settings = {
                title: gameTitle,
                description: gameDescription,
                lastUpdated: new Date().toISOString()
            };
            
            localStorage.setItem('game_settings', JSON.stringify(settings));
            showNotification('‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–≥—Ä—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!', 'success');
        }

        // –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => notification.classList.add('show'), 100);
            
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => document.body.removeChild(notification), 300);
            }, 3000);
        }

        // –í—ã—Ö–æ–¥
        function logout() {
            localStorage.removeItem('admin_access');
            location.reload();
        }
    </script>
</body>
</html>
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å - –ù–æ–≤–æ–≥–æ–¥–Ω—è—è –û—Ö–æ—Ç–∞</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .admin-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 3px solid #667eea;
        }

        .header h1 {
            color: #667eea;
            font-size: 32px;
            margin-bottom: 10px;
        }

        .header .subtitle {
            color: #666;
            font-size: 16px;
        }

        .section {
            margin-bottom: 40px;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 15px;
            border-left: 5px solid #667eea;
        }

        .section h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 24px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #333;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 10px rgba(102, 126, 234, 0.3);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.6);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .btn-danger {
            background: linear-gradient(135deg, #f5576c 0%, #c23d4f 100%);
        }

        .btn-success {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
        }

        .task-item {
            background: white;
            padding: 20px;
            margin-bottom: 15px;
            border-radius: 10px;
            border-left: 5px solid #43e97b;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        }

        .task-item h3 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .task-item .task-details {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid #eee;
        }

        .task-item .task-details span {
            color: #666;
            font-size: 14px;
        }

        .task-actions {
            margin-top: 15px;
            display: flex;
            gap: 10px;
        }

        .task-actions button {
            padding: 8px 20px;
            font-size: 14px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
        }

        .stat-card .label {
            font-size: 14px;
            opacity: 0.9;
            margin-bottom: 10px;
        }

        .stat-card .value {
            font-size: 36px;
            font-weight: bold;
        }

        .team-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .team-table th,
        .team-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        .team-table th {
            background: #667eea;
            color: white;
            font-weight: bold;
        }

        .team-table tr:hover {
            background: #f8f9fa;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 20px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-header h3 {
            color: #667eea;
            font-size: 24px;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 30px;
            cursor: pointer;
            color: #999;
        }

        .close-btn:hover {
            color: #333;
        }

        .alert {
            padding: 15px 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .alert-success {
            background: #d4edda;
            color: #155724;
            border-left: 5px solid #28a745;
        }

        .alert-warning {
            background: #fff3cd;
            color: #856404;
            border-left: 5px solid #ffc107;
        }

        .alert-info {
            background: #d1ecf1;
            color: #0c5460;
            border-left: 5px solid #17a2b8;
        }

        @media (max-width: 768px) {
            .admin-container {
                padding: 20px;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="admin-container">
        <div class="header">
            <h1>üéÑ –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</h1>
            <div class="subtitle">–ù–æ–≤–æ–≥–æ–¥–Ω—è—è –û—Ö–æ—Ç–∞ –∑–∞ –°–æ–∫—Ä–æ–≤–∏—â–∞–º–∏ 2025</div>
        </div>

        <div class="alert alert-info">
            <strong>‚ÑπÔ∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:</strong> –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ localStorage –±—Ä–∞—É–∑–µ—Ä–∞. –î–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–∏ –¥–æ–ª–∂–Ω—ã –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É.
        </div>

        <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
        <div class="section">
            <h2>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏</h2>
            <div class="stats-grid">
                <div class="stat-card" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);">
                    <div class="label">üë• –ö–æ–º–∞–Ω–¥</div>
                    <div class="value" id="totalTeams">0</div>
                </div>
                <div class="stat-card" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                    <div class="label">‚úÖ –ê–∫—Ç–∏–≤–Ω—ã—Ö –∏–≥—Ä</div>
                    <div class="value" id="activeGames">0</div>
                </div>
                <div class="stat-card" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">
                    <div class="label">üèÜ –°—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª</div>
                    <div class="value" id="avgScore">0</div>
                </div>
            </div>

            <table class="team-table">
                <thead>
                    <tr>
                        <th>üèÖ –ú–µ—Å—Ç–æ</th>
                        <th>üë• –ö–æ–º–∞–Ω–¥–∞</th>
                        <th>üë§ –ö–∞–ø–∏—Ç–∞–Ω</th>
                        <th>‚≠ê –û—á–∫–∏</th>
                        <th>‚úÖ –ó–∞–¥–∞–Ω–∏—è</th>
                        <th>‚è± –í—Ä–µ–º—è</th>
                    </tr>
                </thead>
                <tbody id="teamsTableBody">
                    <tr>
                        <td colspan="6" style="text-align: center; color: #999;">–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–æ–º–∞–Ω–¥</td>
                    </tr>
                </tbody>
            </table>
            <div style="margin-top: 20px; display: flex; gap: 10px; flex-wrap: wrap;">
                <button class="btn btn-secondary" onclick="refreshStats()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</button>
                <button class="btn btn-danger" onclick="resetLeaderboard()">üîÑ –°–±—Ä–æ—Å–∏—Ç—å —Ä–µ–π—Ç–∏–Ω–≥</button>
                <button class="btn btn-danger" onclick="clearAllData()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ</button>
            </div>
        </div>

        <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–≥—Ä—ã -->
        <div class="section">
            <h2>‚öôÔ∏è –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
            <div class="form-row">
                <div class="form-group">
                    <label>‚è± –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏–≥—Ä—ã (–º–∏–Ω—É—Ç—ã)</label>
                    <input type="number" id="gameDuration" value="20" min="5" max="120">
                </div>
                <div class="form-group">
                    <label>üí° –®—Ç—Ä–∞—Ñ –∑–∞ –ø–æ–¥—Å–∫–∞–∑–∫—É (–æ—á–∫–∏)</label>
                    <input type="number" id="hintPenalty" value="10" min="0" max="100">
                </div>
            </div>
            <button class="btn btn-success" onclick="saveGameSettings()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</button>
        </div>

        <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è–º–∏ -->
        <div class="section">
            <h2>üìã –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è–º–∏</h2>
            <button class="btn" onclick="openTaskModal()">‚ûï –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ</button>
            <div id="tasksList" style="margin-top: 20px;">
                <!-- –°–ø–∏—Å–æ–∫ –∑–∞–¥–∞–Ω–∏–π –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–¥–∞–Ω–∏—è -->
    <div class="modal" id="taskModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">–ù–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ</h3>
                <button class="close-btn" onclick="closeTaskModal()">√ó</button>
            </div>
            <div class="form-group">
                <label>üìå –ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è</label>
                <input type="text" id="taskTitle" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: üéÑ –ù–æ–≤–æ–≥–æ–¥–Ω—è—è –µ–ª–∫–∞">
            </div>
            <div class="form-group">
                <label>üìù –û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è</label>
                <textarea id="taskDescription" placeholder="–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≥–æ, —á—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —É—á–∞—Å—Ç–Ω–∏–∫–∞–º..."></textarea>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label>üîë –ö–æ–¥–æ–≤–æ–µ —Å–ª–æ–≤–æ (–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç)</label>
                    <input type="text" id="taskCode" placeholder="–ó–í–ï–ó–î–ê">
                </div>
                <div class="form-group">
                    <label>‚≠ê –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—á–∫–æ–≤</label>
                    <input type="number" id="taskPoints" value="100" min="10" max="1000">
                </div>
            </div>
            <div class="form-group">
                <label>üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞</label>
                <textarea id="taskHint" placeholder="–ü–æ–¥—Å–∫–∞–∑–∫–∞, –∫–æ—Ç–æ—Ä—É—é –º–æ–∂–Ω–æ –∫—É–ø–∏—Ç—å –∑–∞ —à—Ç—Ä–∞—Ñ–Ω—ã–µ –æ—á–∫–∏..."></textarea>
            </div>
            <button class="btn btn-success" onclick="saveTask()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ</button>
        </div>
    </div>

    <script>
        let currentEditingTaskId = null;

        // –ü—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è –¥–ª—è –Ω–æ–≤–æ–≥–æ–¥–Ω–µ–≥–æ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–∞
        const defaultTasks = [
            {
                id: 1,
                title: "üéÑ –ù–æ–≤–æ–≥–æ–¥–Ω—è—è –µ–ª–∫–∞",
                description: "–ù–∞–π–¥–∏—Ç–µ –≥–ª–∞–≤–Ω—É—é –Ω–æ–≤–æ–≥–æ–¥–Ω—é—é –µ–ª–∫—É –≤ –∑–∞–ª–µ. –°—Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—Ä—É–π—Ç–µ —Å–∞–º—É—é –Ω–µ–æ–±—ã—á–Ω—É—é –∏–≥—Ä—É—à–∫—É –Ω–∞ –Ω–µ–π –∏ –≤–≤–µ–¥–∏—Ç–µ –∫–æ–¥–æ–≤–æ–µ —Å–ª–æ–≤–æ, –Ω–∞–ø–∏—Å–∞–Ω–Ω–æ–µ –Ω–∞ –∑–≤–µ–∑–¥–µ.",
                code: "–ó–í–ï–ó–î–ê",
                points: 50,
                hint: "–ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ –≤–µ—Ä—Ö—É—à–∫—É –µ–ª–∫–∏ –ø–æ–≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–µ–µ"
            },
            {
                id: 2,
                title: "üéÖ –î–µ–¥ –ú–æ—Ä–æ–∑ –∏ –°–Ω–µ–≥—É—Ä–æ—á–∫–∞",
                description: "–û—Ç—ã—â–∏—Ç–µ —Ñ–∏–≥—É—Ä—ã –î–µ–¥–∞ –ú–æ—Ä–æ–∑–∞ –∏ –°–Ω–µ–≥—É—Ä–æ—á–∫–∏. –ü–æ—Å—á–∏—Ç–∞–π—Ç–µ —Å–∫–æ–ª—å–∫–æ —Å–Ω–µ–∂–∏–Ω–æ–∫ –Ω–∞ –ø–æ—Å–æ—Ö–µ –î–µ–¥–∞ –ú–æ—Ä–æ–∑–∞.",
                code: "12",
                points: 75,
                hint: "–ò—â–∏—Ç–µ –∏—Ö —Ä—è–¥–æ–º —Å —Ñ–æ—Ç–æ–∑–æ–Ω–æ–π"
            },
            {
                id: 3,
                title: "üçæ –®–∞–º–ø–∞–Ω—Å–∫–æ–µ",
                description: "–ù–∞–π–¥–∏—Ç–µ –±—É—Ç—ã–ª–∫—É —à–∞–º–ø–∞–Ω—Å–∫–æ–≥–æ —Å –∑–æ–ª–æ—Ç–æ–π –ª–µ–Ω—Ç–æ–π. –ö–∞–∫–æ–π –≥–æ–¥ —É–∫–∞–∑–∞–Ω –Ω–∞ —ç—Ç–∏–∫–µ—Ç–∫–µ?",
                code: "2025",
                points: 60,
                hint: "–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –±–∞—Ä–Ω—É—é —Å—Ç–æ–π–∫—É"
            },
            {
                id: 4,
                title: "üéÅ –ó–∞–≥–∞–¥–æ—á–Ω—ã–π –ø–æ–¥–∞—Ä–æ–∫",
                description: "–ü–æ–¥ –æ–¥–Ω–∏–º –∏–∑ —Å—Ç–æ–ª–æ–≤ —Å–ø—Ä—è—Ç–∞–Ω–∞ –∫–æ—Ä–æ–±–∫–∞ —Å –ø–æ–¥–∞—Ä–∫–æ–º. –ù–∞–π–¥–∏—Ç–µ –µ—ë –∏ –≤–≤–µ–¥–∏—Ç–µ —Ü–≤–µ—Ç –±–∞–Ω—Ç–∞.",
                code: "–ö–†–ê–°–ù–´–ô",
                points: 100,
                hint: "–ò—â–∏—Ç–µ –ø–æ–¥ —Å—Ç–æ–ª–æ–º –Ω–æ–º–µ—Ä 7"
            },
            {
                id: 5,
                title: "‚ùÑÔ∏è –°–Ω–µ–∂–∏–Ω–∫–∞",
                description: "–í –∑–∞–ª–µ –≤–∏—Å—è—Ç –±—É–º–∞–∂–Ω—ã–µ —Å–Ω–µ–∂–∏–Ω–∫–∏. –ù–∞–π–¥–∏—Ç–µ —Ç—É, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–π –Ω–∞–ø–∏—Å–∞–Ω–æ –∫–æ–¥–æ–≤–æ–µ —Å–ª–æ–≤–æ.",
                code: "–ú–ï–¢–ï–õ–¨",
                points: 80,
                hint: "–°–Ω–µ–∂–∏–Ω–∫–∏ –≤–∏—Å—è—Ç –Ω–∞ –æ–∫–Ω–∞—Ö"
            }
        ];

        // –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
        window.onload = function() {
            initializeDefaultTasks();
            loadGameSettings();
            loadTasks();
            refreshStats();
            
            // –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥
            setInterval(refreshStats, 5000);
        };

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞–Ω–∏–π
        function initializeDefaultTasks() {
            const existingTasks = localStorage.getItem('gameTasks');
            if (!existingTasks || existingTasks === '[]') {
                localStorage.setItem('gameTasks', JSON.stringify(defaultTasks));
            }
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∏–≥—Ä—ã
        function saveGameSettings() {
            const duration = document.getElementById('gameDuration').value;
            const hintPenalty = document.getElementById('hintPenalty').value;

            const config = {
                duration: parseInt(duration),
                hintPenalty: parseInt(hintPenalty)
            };

            localStorage.setItem('gameConfig', JSON.stringify(config));
            showAlert('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!', 'success');
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∏–≥—Ä—ã
        function loadGameSettings() {
            const config = JSON.parse(localStorage.getItem('gameConfig') || '{"duration": 20, "hintPenalty": 10}');
            document.getElementById('gameDuration').value = config.duration;
            document.getElementById('hintPenalty').value = config.hintPenalty;
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–¥–∞–Ω–∏–π
        function loadTasks() {
            const tasks = JSON.parse(localStorage.getItem('gameTasks') || '[]');
            const tasksList = document.getElementById('tasksList');
            
            if (tasks.length === 0) {
                tasksList.innerHTML = '<p style="text-align: center; color: #999; padding: 20px;">–ù–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞–Ω–∏–π. –ù–∞–∂–º–∏—Ç–µ "–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ"</p>';
                return;
            }

            tasksList.innerHTML = '';
            tasks.forEach((task, index) => {
                const taskItem = document.createElement('div');
                taskItem.className = 'task-item';
                taskItem.innerHTML = `
                    <h3>${index + 1}. ${task.title}</h3>
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin: 10px 0;">
                        <p style="color: #333; margin: 5px 0; line-height: 1.6;"><strong>üìù –û–ø–∏—Å–∞–Ω–∏–µ:</strong> ${task.description}</p>
                    </div>
                    <div class="task-details" style="background: #fff3cd; padding: 15px; border-radius: 8px; margin: 10px 0;">
                        <div style="margin-bottom: 10px;">
                            <strong>üîë –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç (–∫–æ–¥):</strong> 
                            <span style="background: #fff; padding: 5px 15px; border-radius: 5px; font-family: monospace; font-size: 16px; color: #28a745; font-weight: bold;">${task.code}</span>
                        </div>
                        <div style="margin-bottom: 10px;">
                            <strong>‚≠ê –ù–∞–≥—Ä–∞–¥–∞:</strong> <span style="color: #667eea; font-weight: bold;">${task.points} –æ—á–∫–æ–≤</span>
                        </div>
                        <div>
                            <strong>üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞:</strong> <span style="color: #666;">${task.hint || '–ù–µ —É–∫–∞–∑–∞–Ω–∞'}</span>
                        </div>
                    </div>
                    <div class="task-actions">
                        <button class="btn btn-secondary" onclick="editTask(${task.id})">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                        <button class="btn btn-danger" onclick="deleteTask(${task.id})">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</button>
                    </div>
                `;
                tasksList.appendChild(taskItem);
            });
        }

        // –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
        function openTaskModal(taskId = null) {
            currentEditingTaskId = taskId;
            const modal = document.getElementById('taskModal');
            
            if (taskId) {
                // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è
                const tasks = JSON.parse(localStorage.getItem('gameTasks') || '[]');
                const task = tasks.find(t => t.id === taskId);
                
                document.getElementById('modalTitle').textContent = '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–¥–∞–Ω–∏–µ';
                document.getElementById('taskTitle').value = task.title;
                document.getElementById('taskDescription').value = task.description;
                document.getElementById('taskCode').value = task.code;
                document.getElementById('taskPoints').value = task.points;
                document.getElementById('taskHint').value = task.hint;
            } else {
                // –ù–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ
                document.getElementById('modalTitle').textContent = '–ù–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ';
                document.getElementById('taskTitle').value = '';
                document.getElementById('taskDescription').value = '';
                document.getElementById('taskCode').value = '';
                document.getElementById('taskPoints').value = '50';
                document.getElementById('taskHint').value = '';
            }
            
            modal.classList.add('active');
        }

        function closeTaskModal() {
            document.getElementById('taskModal').classList.remove('active');
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è
        function saveTask() {
            const title = document.getElementById('taskTitle').value.trim();
            const description = document.getElementById('taskDescription').value.trim();
            const code = document.getElementById('taskCode').value.trim();
            const points = parseInt(document.getElementById('taskPoints').value);
            const hint = document.getElementById('taskHint').value.trim();

            if (!title || !description || !code) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è!');
                return;
            }

            let tasks = JSON.parse(localStorage.getItem('gameTasks') || '[]');
            
            if (currentEditingTaskId) {
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ
                const index = tasks.findIndex(t => t.id === currentEditingTaskId);
                tasks[index] = {
                    id: currentEditingTaskId,
                    title, description, code, points, hint
                };
            } else {
                // –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ
                const newTask = {
                    id: Date.now(),
                    title, description, code, points, hint
                };
                tasks.push(newTask);
            }

            localStorage.setItem('gameTasks', JSON.stringify(tasks));
            closeTaskModal();
            loadTasks();
            showAlert('–ó–∞–¥–∞–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ!', 'success');
        }

        // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è
        function editTask(taskId) {
            openTaskModal(taskId);
        }

        // –£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è
        function deleteTask(taskId) {
            if (!confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ –∑–∞–¥–∞–Ω–∏–µ?')) return;
            
            let tasks = JSON.parse(localStorage.getItem('gameTasks') || '[]');
            tasks = tasks.filter(t => t.id !== taskId);
            localStorage.setItem('gameTasks', JSON.stringify(tasks));
            loadTasks();
            showAlert('–ó–∞–¥–∞–Ω–∏–µ —É–¥–∞–ª–µ–Ω–æ!', 'warning');
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        function refreshStats() {
            const teams = JSON.parse(localStorage.getItem('scavengerTeams') || '[]');
            
            document.getElementById('totalTeams').textContent = teams.length;
            document.getElementById('activeGames').textContent = teams.length;
            
            const avgScore = teams.length > 0 
                ? Math.round(teams.reduce((sum, t) => sum + t.score, 0) / teams.length)
                : 0;
            document.getElementById('avgScore').textContent = avgScore;

            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –∫–æ–º–∞–Ω–¥
            const tbody = document.getElementById('teamsTableBody');
            
            if (teams.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" style="text-align: center; color: #999;">–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–æ–º–∞–Ω–¥</td></tr>';
                return;
            }

            tbody.innerHTML = '';
            teams.forEach((team, index) => {
                const medal = index === 0 ? 'ü•á' : index === 1 ? 'ü•à' : index === 2 ? 'ü•â' : (index + 1);
                const timeSpent = Math.floor(team.time / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;

                const row = document.createElement('tr');
                row.innerHTML = `
                    <td><strong>${medal}</strong></td>
                    <td>${team.name}</td>
                    <td>${team.captain}</td>
                    <td><strong style="color: #43e97b;">${team.score}</strong></td>
                    <td>${team.completed}/${team.total}</td>
                    <td>${minutes}:${String(seconds).padStart(2, '0')}</td>
                `;
                tbody.appendChild(row);
            });
        }

        // –°–±—Ä–æ—Å —Ç–æ–ª—å–∫–æ —Ä–µ–π—Ç–∏–Ω–≥–∞ –∫–æ–º–∞–Ω–¥
        function resetLeaderboard() {
            if (!confirm('üîÑ –°–±—Ä–æ—Å–∏—Ç—å —Ä–µ–π—Ç–∏–Ω–≥ –≤—Å–µ—Ö –∫–æ–º–∞–Ω–¥? –ó–∞–¥–∞–Ω–∏—è –æ—Å—Ç–∞–Ω—É—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π.')) return;
            
            localStorage.removeItem('scavengerTeams');
            refreshStats();
            showAlert('–†–µ–π—Ç–∏–Ω–≥ –∫–æ–º–∞–Ω–¥ —Å–±—Ä–æ—à–µ–Ω!', 'success');
        }

        // –û—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö
        function clearAllData() {
            if (!confirm('‚ö†Ô∏è –í—ã —É–≤–µ—Ä–µ–Ω—ã? –≠—Ç–æ —É–¥–∞–ª–∏—Ç –í–°–ï –¥–∞–Ω–Ω—ã–µ –æ –∫–æ–º–∞–Ω–¥–∞—Ö, –ø—Ä–æ–≥—Ä–µ—Å—Å–µ –∏–≥—Ä—ã –ò –∑–∞–¥–∞–Ω–∏—è—Ö!')) return;
            
            localStorage.removeItem('scavengerTeams');
            localStorage.removeItem('gameTasks');
            localStorage.removeItem('gameConfig');
            refreshStats();
            loadTasks();
            loadGameSettings();
            showAlert('–í—Å–µ –¥–∞–Ω–Ω—ã–µ –æ—á–∏—â–µ–Ω—ã! –°—Ç—Ä–∞–Ω–∏—Ü–∞ –±—É–¥–µ—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω–∞.', 'warning');
            setTimeout(() => location.reload(), 2000);
        }

        // –ü–æ–∫–∞–∑ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        function showAlert(message, type) {
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type}`;
            alertDiv.textContent = message;
            alertDiv.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                z-index: 2000;
                min-width: 300px;
                animation: slideIn 0.3s ease;
            `;
            document.body.appendChild(alertDiv);

            setTimeout(() => {
                alertDiv.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => alertDiv.remove(), 300);
            }, 3000);
        }

        // –°—Ç–∏–ª–∏ –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–π
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(400px); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(400px); opacity: 0; }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å —Å GitHub API</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .admin-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 3px solid #667eea;
        }

        .header h1 {
            color: #667eea;
            font-size: 32px;
            margin-bottom: 10px;
        }

        .header .subtitle {
            color: #666;
            font-size: 16px;
        }

        .alert {
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 30px;
            border-left: 5px solid;
        }

        .alert-info {
            background: #d1ecf1;
            color: #0c5460;
            border-color: #17a2b8;
        }

        .alert-success {
            background: #d4edda;
            color: #155724;
            border-color: #28a745;
        }

        .alert-warning {
            background: #fff3cd;
            color: #856404;
            border-color: #ffc107;
        }

        .alert-error {
            background: #f8d7da;
            color: #721c24;
            border-color: #f5576c;
        }

        .section {
            margin-bottom: 40px;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 15px;
            border-left: 5px solid #667eea;
        }

        .section h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 24px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            color: #333;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s;
        }

        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 10px rgba(102, 126, 234, 0.3);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 80px;
            font-family: inherit;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.6);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn-success {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
        }

        .btn-danger {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #a8a8a8 0%, #7f7f7f 100%);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
        }

        .stat-card .label {
            font-size: 14px;
            opacity: 0.9;
            margin-bottom: 10px;
        }

        .stat-card .value {
            font-size: 36px;
            font-weight: bold;
        }

        .task-item {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 15px;
            border: 2px solid #ddd;
            transition: all 0.3s;
        }

        .task-item:hover {
            border-color: #667eea;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.2);
        }

        .task-item h4 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .task-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .task-actions button {
            flex: 1;
            padding: 8px;
            border-radius: 8px;
            font-size: 14px;
        }

        .github-status {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
        }

        .status-connected {
            background: #d4edda;
            color: #155724;
        }

        .status-disconnected {
            background: #f8d7da;
            color: #721c24;
        }

        .loading {
            text-align: center;
            padding: 20px;
            color: #667eea;
            font-size: 18px;
        }

        .hidden {
            display: none;
        }

        @media (max-width: 768px) {
            .admin-container {
                padding: 20px;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="admin-container">
        <div class="header">
            <h1>üéÑ –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å —Å GitHub Integration</h1>
            <div class="subtitle">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–π —á–µ—Ä–µ–∑ GitHub API</div>
        </div>

        <!-- GitHub –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ -->
        <div class="section">
            <h2>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ GitHub</h2>
            <div id="githubStatusAlert" class="alert alert-warning">
                <strong>‚ö†Ô∏è GitHub –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω!</strong> –í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –Ω–∏–∂–µ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π.
            </div>

            <div class="form-group">
                <label>fancifulaction-rgb:</label>
                <input type="text" id="githubUsername" value="fancifulaction-rgb" placeholder="fancifulaction-rgb">
            </div>

            <div class="form-group">
                <label>christmas_game:</label>
                <input type="text" id="githubRepo" value="christmas_game" placeholder="christmas_game">
            </div>

            <div class="form-group">
                <label>main:</label>
                <input type="text" id="githubBranch" value="main" placeholder="main">
            </div>

            <div class="form-group">
                <label>Personal Access Token: <a href="–ò–ù–°–¢–†–£–ö–¶–ò–Ø_GITHUB_TOKEN.md" target="_blank" style="color: #667eea;">(üìñ –ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å?)</a></label>
                <input type="password" id="githubToken" placeholder="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">
                <small style="color: #666; display: block; margin-top: 5px;">–¢–æ–∫–µ–Ω –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω –ª–æ–∫–∞–ª—å–Ω–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ</small>
            </div>

            <button class="btn btn-success" onclick="saveGitHubSettings()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</button>
            <button class="btn btn-secondary" onclick="testGitHubConnection()" style="margin-left: 10px;">üîå –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ</button>
        </div>

        <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
        <div class="section">
            <h2>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
            <div class="stats-grid">
                <div class="stat-card" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);">
                    <div class="label">üìã –ó–∞–¥–∞–Ω–∏–π</div>
                    <div class="value" id="totalTasks">0</div>
                </div>
                <div class="stat-card" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                    <div class="label">‚è± –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</div>
                    <div class="value" id="gameDuration">0 –º–∏–Ω</div>
                </div>
                <div class="stat-card" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">
                    <div class="label">‚≠ê –®—Ç—Ä–∞—Ñ –∑–∞ –ø–æ–¥—Å–∫–∞–∑–∫—É</div>
                    <div class="value" id="hintPenalty">0</div>
                </div>
            </div>
        </div>

        <!-- –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–≥—Ä—ã -->
        <div class="section">
            <h2>üéÆ –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–≥—Ä—ã</h2>
            
            <div class="form-row">
                <div class="form-group">
                    <label>‚è± –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏–≥—Ä—ã (–º–∏–Ω—É—Ç):</label>
                    <input type="number" id="configDuration" value="20" min="1" max="120">
                </div>
                <div class="form-group">
                    <label>‚≠ê –®—Ç—Ä–∞—Ñ –∑–∞ –ø–æ–¥—Å–∫–∞–∑–∫—É (–æ—á–∫–æ–≤):</label>
                    <input type="number" id="configHintPenalty" value="10" min="0" max="100">
                </div>
            </div>
        </div>

        <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è–º–∏ -->
        <div class="section">
            <h2>üìù –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è–º–∏</h2>
            
            <button class="btn btn-success" onclick="addNewTask()" style="margin-bottom: 20px;">‚ûï –î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ</button>
            
            <div id="tasksList">
                <!-- –ó–∞–¥–∞–Ω–∏—è –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã —Å—é–¥–∞ -->
            </div>
        </div>

        <!-- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ -->
        <div class="section">
            <h2>üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π</h2>
            
            <div class="alert alert-info">
                <strong>‚ÑπÔ∏è –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:</strong><br>
                –ü–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è –∫–Ω–æ–ø–∫–∏ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ GitHub" –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∑—è—Ç—Å—è –≤ —Ñ–∞–π–ª <code>game-data.json</code> –≤ –≤–∞—à–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.<br>
                –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤—Å—Ç—É–ø—è—Ç –≤ —Å–∏–ª—É –Ω–∞ –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏–≥—Ä—ã.
            </div>

            <button class="btn btn-success" onclick="saveToGitHub()" style="font-size: 18px; padding: 15px 40px;">
                üì§ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ GitHub
            </button>
            
            <button class="btn" onclick="loadFromGitHub()" style="margin-left: 10px;">
                üîÑ –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ GitHub
            </button>
        </div>

        <!-- –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏ -->
        <div class="section">
            <h2>üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏</h2>
            <p style="margin-bottom: 15px;">
                <a href="index.html" class="btn">üéÆ –û—Ç–∫—Ä—ã—Ç—å –∏–≥—Ä—É</a>
                <a href="https://github.com/fancifulaction-rgb/christmas_game" class="btn" target="_blank" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); margin-left: 10px;">üìÇ –û—Ç–∫—Ä—ã—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π</a>
                <a href="–ò–ù–°–¢–†–£–ö–¶–ò–Ø_GITHUB_TOKEN.md" class="btn" target="_blank" style="background: linear-gradient(135deg, #ffc107 0%, #ff9800 100%); margin-left: 10px;">üìñ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Ç–æ–∫–µ–Ω—É</a>
            </p>
        </div>
    </div>

    <script>
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let gameData = {
            config: {
                duration: 20,
                hintPenalty: 10
            },
            tasks: [],
            teams: []
        };

        let githubSettings = {
            username: 'fancifulaction-rgb',
            repo: 'christmas_game',
            branch: 'main',
            token: ''
        };

        // –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.onload = function() {
            loadGitHubSettings();
            loadGameData();
        };

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ GitHub
        function saveGitHubSettings() {
            githubSettings.username = document.getElementById('githubUsername').value.trim();
            githubSettings.repo = document.getElementById('githubRepo').value.trim();
            githubSettings.branch = document.getElementById('githubBranch').value.trim();
            githubSettings.token = document.getElementById('githubToken').value.trim();

            if (!githubSettings.username || !githubSettings.repo || !githubSettings.token) {
                alert('‚ùå –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è!');
                return;
            }

            localStorage.setItem('githubSettings', JSON.stringify(githubSettings));
            showAlert('‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ GitHub —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!', 'success');
            updateGitHubStatus(true);
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ GitHub
        function loadGitHubSettings() {
            const saved = localStorage.getItem('githubSettings');
            if (saved) {
                try {
                    githubSettings = JSON.parse(saved);
                    document.getElementById('githubUsername').value = githubSettings.username || 'fancifulaction-rgb';
                    document.getElementById('githubRepo').value = githubSettings.repo || 'christmas_game';
                    document.getElementById('githubBranch').value = githubSettings.branch || 'main';
                    document.getElementById('githubToken').value = githubSettings.token || '';
                    
                    if (githubSettings.token) {
                        updateGitHubStatus(true);
                    }
                } catch (e) {
                    console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫:', e);
                }
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
        function updateGitHubStatus(connected) {
            const alert = document.getElementById('githubStatusAlert');
            if (connected) {
                alert.className = 'alert alert-success';
                alert.innerHTML = '<strong>‚úÖ GitHub –ø–æ–¥–∫–ª—é—á–µ–Ω!</strong> –í—ã –º–æ–∂–µ—Ç–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.';
            } else {
                alert.className = 'alert alert-warning';
                alert.innerHTML = '<strong>‚ö†Ô∏è GitHub –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω!</strong> –í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –Ω–∏–∂–µ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π.';
            }
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ GitHub
        async function testGitHubConnection() {
            if (!githubSettings.token) {
                alert('‚ùå –°–Ω–∞—á–∞–ª–∞ —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ GitHub!');
                return;
            }

            showAlert('üîÑ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è...', 'info');

            try {
                const response = await fetch(
                    `https://api.github.com/repos/${githubSettings.username}/${githubSettings.repo}`,
                    {
                        headers: {
                            'Authorization': `token ${githubSettings.token}`,
                            'Accept': 'application/vnd.github.v3+json'
                        }
                    }
                );

                if (response.ok) {
                    const data = await response.json();
                    showAlert(`‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ! –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: ${data.full_name}`, 'success');
                    updateGitHubStatus(true);
                } else if (response.status === 401) {
                    showAlert('‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π —Ç–æ–∫–µ–Ω! –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Personal Access Token.', 'error');
                } else if (response.status === 404) {
                    showAlert('‚ùå –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–µ –Ω–∞–π–¥–µ–Ω! –ü—Ä–æ–≤–µ—Ä—å—Ç–µ username –∏ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è.', 'error');
                } else {
                    showAlert(`‚ùå –û—à–∏–±–∫–∞: ${response.status} ${response.statusText}`, 'error');
                }
            } catch (error) {
                showAlert('‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è: ' + error.message, 'error');
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ game-data.json (–ª–æ–∫–∞–ª—å–Ω–æ –∏–ª–∏ –∏–∑ GitHub)
        async function loadGameData() {
            try {
                const response = await fetch('game-data.json');
                if (response.ok) {
                    gameData = await response.json();
                    updateUI();
                    showAlert('‚úÖ –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ñ–∞–π–ª–∞', 'success');
                } else {
                    // –ï—Å–ª–∏ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –Ω–µ—Ç, –∑–∞–≥—Ä—É–∂–∞–µ–º –∏–∑ GitHub
                    await loadFromGitHub();
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:', error);
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø—É—Å—Ç—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
                updateUI();
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ GitHub
        async function loadFromGitHub() {
            if (!githubSettings.token) {
                alert('‚ùå –°–Ω–∞—á–∞–ª–∞ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ GitHub!');
                return;
            }

            showAlert('üîÑ –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ GitHub...', 'info');

            try {
                const response = await fetch(
                    `https://api.github.com/repos/${githubSettings.username}/${githubSettings.repo}/contents/game-data.json?ref=${githubSettings.branch}`,
                    {
                        headers: {
                            'Authorization': `token ${githubSettings.token}`,
                            'Accept': 'application/vnd.github.v3+json'
                        }
                    }
                );

                if (response.ok) {
                    const data = await response.json();
                    const content = atob(data.content);
                    gameData = JSON.parse(content);
                    updateUI();
                    showAlert('‚úÖ –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ GitHub!', 'success');
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
            } catch (error) {
                showAlert('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑ GitHub: ' + error.message, 'error');
            }
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ GitHub
        async function saveToGitHub() {
            if (!githubSettings.token) {
                alert('‚ùå –°–Ω–∞—á–∞–ª–∞ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ GitHub!');
                return;
            }

            // –°–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ñ–æ—Ä–º—ã
            collectFormData();

            showAlert('üîÑ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ GitHub...', 'info');

            try {
                // –ü–æ–ª—É—á–∞–µ–º SHA —Ç–µ–∫—É—â–µ–≥–æ —Ñ–∞–π–ª–∞
                const getResponse = await fetch(
                    `https://api.github.com/repos/${githubSettings.username}/${githubSettings.repo}/contents/game-data.json?ref=${githubSettings.branch}`,
                    {
                        headers: {
                            'Authorization': `token ${githubSettings.token}`,
                            'Accept': 'application/vnd.github.v3+json'
                        }
                    }
                );

                let sha = null;
                if (getResponse.ok) {
                    const fileData = await getResponse.json();
                    sha = fileData.sha;
                }

                // –ö–æ–¥–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –≤ base64
                const content = btoa(unescape(encodeURIComponent(JSON.stringify(gameData, null, 2))));

                // –°–æ–∑–¥–∞–µ–º –∏–ª–∏ –æ–±–Ω–æ–≤–ª—è–µ–º —Ñ–∞–π–ª
                const putResponse = await fetch(
                    `https://api.github.com/repos/${githubSettings.username}/${githubSettings.repo}/contents/game-data.json`,
                    {
                        method: 'PUT',
                        headers: {
                            'Authorization': `token ${githubSettings.token}`,
                            'Accept': 'application/vnd.github.v3+json',
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            message: `Update game data - ${new Date().toLocaleString('ru-RU')}`,
                            content: content,
                            sha: sha,
                            branch: githubSettings.branch
                        })
                    }
                );

                if (putResponse.ok) {
                    showAlert('‚úÖ –î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ GitHub! –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤—Å—Ç—É–ø—è—Ç –≤ —Å–∏–ª—É —á–µ—Ä–µ–∑ 1-2 –º–∏–Ω—É—Ç—ã.', 'success');
                } else {
                    const error = await putResponse.json();
                    throw new Error(error.message || `HTTP ${putResponse.status}`);
                }
            } catch (error) {
                showAlert('‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ GitHub: ' + error.message, 'error');
            }
        }

        // –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ñ–æ—Ä–º—ã
        function collectFormData() {
            gameData.config.duration = parseInt(document.getElementById('configDuration').value);
            gameData.config.hintPenalty = parseInt(document.getElementById('configHintPenalty').value);

            // –°–æ–±–∏—Ä–∞–µ–º –∑–∞–¥–∞–Ω–∏—è
            const taskElements = document.querySelectorAll('.task-item');
            gameData.tasks = [];
            
            taskElements.forEach((elem, index) => {
                const task = {
                    id: parseInt(elem.querySelector('[data-field="id"]').value),
                    title: elem.querySelector('[data-field="title"]').value,
                    description: elem.querySelector('[data-field="description"]').value,
                    code: elem.querySelector('[data-field="code"]').value,
                    points: parseInt(elem.querySelector('[data-field="points"]').value),
                    hint: elem.querySelector('[data-field="hint"]').value
                };
                gameData.tasks.push(task);
            });
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
        function updateUI() {
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
            document.getElementById('totalTasks').textContent = gameData.tasks.length;
            document.getElementById('gameDuration').textContent = gameData.config.duration + ' –º–∏–Ω';
            document.getElementById('hintPenalty').textContent = gameData.config.hintPenalty;

            // –û–±–Ω–æ–≤–ª—è–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
            document.getElementById('configDuration').value = gameData.config.duration;
            document.getElementById('configHintPenalty').value = gameData.config.hintPenalty;

            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –∑–∞–¥–∞–Ω–∏–π
            renderTasks();
        }

        // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –∑–∞–¥–∞–Ω–∏–π
        function renderTasks() {
            const container = document.getElementById('tasksList');
            container.innerHTML = '';

            if (gameData.tasks.length === 0) {
                container.innerHTML = '<p style="color: #666; text-align: center;">–ù–µ—Ç –∑–∞–¥–∞–Ω–∏–π. –ù–∞–∂–º–∏—Ç–µ "–î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ"</p>';
                return;
            }

            gameData.tasks.forEach((task, index) => {
                const taskDiv = document.createElement('div');
                taskDiv.className = 'task-item';
                taskDiv.innerHTML = `
                    <h4>–ó–∞–¥–∞–Ω–∏–µ ${index + 1}</h4>
                    <div class="form-group">
                        <label>ID –∑–∞–¥–∞–Ω–∏—è:</label>
                        <input type="number" data-field="id" value="${task.id}" readonly style="background: #f0f0f0;">
                    </div>
                    <div class="form-group">
                        <label>üéØ –ù–∞–∑–≤–∞–Ω–∏–µ:</label>
                        <input type="text" data-field="title" value="${task.title}" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: üéÑ –ù–∞–π–¥–∏ –µ–ª–∫—É">
                    </div>
                    <div class="form-group">
                        <label>üìù –û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è:</label>
                        <textarea data-field="description" placeholder="–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è...">${task.description}</textarea>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>üîë –ö–æ–¥–æ–≤–æ–µ —Å–ª–æ–≤–æ:</label>
                            <input type="text" data-field="code" value="${task.code}" placeholder="–ü–†–ê–í–ò–õ–¨–ù–´–ô_–û–¢–í–ï–¢">
                        </div>
                        <div class="form-group">
                            <label>‚≠ê –û—á–∫–∏:</label>
                            <input type="number" data-field="points" value="${task.points}" min="0">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞:</label>
                        <textarea data-field="hint" placeholder="–ü–æ–¥—Å–∫–∞–∑–∫–∞ –¥–ª—è –∏–≥—Ä–æ–∫–æ–≤...">${task.hint}</textarea>
                    </div>
                    <div class="task-actions">
                        <button class="btn btn-danger" onclick="deleteTask(${index})" style="padding: 8px;">üóë –£–¥–∞–ª–∏—Ç—å</button>
                        <button class="btn" onclick="moveTaskUp(${index})" style="padding: 8px;" ${index === 0 ? 'disabled' : ''}>‚¨ÜÔ∏è –í–≤–µ—Ä—Ö</button>
                        <button class="btn" onclick="moveTaskDown(${index})" style="padding: 8px;" ${index === gameData.tasks.length - 1 ? 'disabled' : ''}>‚¨áÔ∏è –í–Ω–∏–∑</button>
                    </div>
                `;
                container.appendChild(taskDiv);
            });
        }

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è
        function addNewTask() {
            const newId = gameData.tasks.length > 0 ? Math.max(...gameData.tasks.map(t => t.id)) + 1 : 1;
            
            const newTask = {
                id: newId,
                title: 'üéÑ –ù–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ',
                description: '–û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è',
                code: '–ö–û–î',
                points: 50,
                hint: '–ü–æ–¥—Å–∫–∞–∑–∫–∞'
            };

            gameData.tasks.push(newTask);
            renderTasks();
            showAlert('‚úÖ –ù–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ!', 'success');
        }

        // –£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è
        function deleteTask(index) {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ –∑–∞–¥–∞–Ω–∏–µ?')) {
                gameData.tasks.splice(index, 1);
                renderTasks();
                updateUI();
                showAlert('‚úÖ –ó–∞–¥–∞–Ω–∏–µ —É–¥–∞–ª–µ–Ω–æ!', 'success');
            }
        }

        // –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è –≤–≤–µ—Ä—Ö
        function moveTaskUp(index) {
            if (index > 0) {
                collectFormData();
                [gameData.tasks[index - 1], gameData.tasks[index]] = [gameData.tasks[index], gameData.tasks[index - 1]];
                renderTasks();
            }
        }

        // –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è –≤–Ω–∏–∑
        function moveTaskDown(index) {
            if (index < gameData.tasks.length - 1) {
                collectFormData();
                [gameData.tasks[index], gameData.tasks[index + 1]] = [gameData.tasks[index + 1], gameData.tasks[index]];
                renderTasks();
            }
        }

        // –ü–æ–∫–∞–∑ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
        function showAlert(message, type) {
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type}`;
            alertDiv.style.cssText = 'position: fixed; top: 20px; right: 20px; z-index: 9999; max-width: 400px; animation: slideIn 0.3s;';
            
            const icons = {
                'success': '‚úÖ',
                'error': '‚ùå',
                'warning': '‚ö†Ô∏è',
                'info': '‚ÑπÔ∏è'
            };
            
            alertDiv.innerHTML = `<strong>${icons[type] || '‚ÑπÔ∏è'}</strong> ${message}`;
            document.body.appendChild(alertDiv);

            setTimeout(() => {
                alertDiv.style.animation = 'slideOut 0.3s';
                setTimeout(() => alertDiv.remove(), 300);
            }, 5000);
        }

        // –°—Ç–∏–ª–∏ –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–π
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(400px); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(400px); opacity: 0; }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
